<!DOCTYPE html>
<html>
<head>
  <title>Drag to Dodge</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      font-family: Arial, sans-serif;
    }
    #gameArea {
      width: 100vw;
      height: 100vh;
      background: #f0f0f0;
      position: relative;
    }
    #player {
      width: 30px;
      height: 30px;
      background: green;
      position: absolute;
      top: 300px;
      left: 50%;
      transform: translateX(-50%);
      border-radius: 50%;
      cursor: grab;
      z-index: 2;
    }
    .obstacle {
      width: 40px;
      height: 40px;
      background: red;
      position: absolute;
      top: 0;
      z-index: 1;
    }
    #gameOver {
      position: absolute;
      top: 40%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2em;
      color: red;
      display: none;
      z-index: 3;
    }
    #restartBtn {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 10px 20px;
      font-size: 1em;
      display: none;
      z-index: 3;
    }
  </style>
</head>
<body>
  <div id="gameArea">
    <div id="player" draggable="true"></div>
    <div id="gameOver">Game Over!</div>
    <button id="restartBtn">Play Again</button>
  </div>

  <script>
    const gameArea = document.getElementById("gameArea");
    const player = document.getElementById("player");
    const gameOverText = document.getElementById("gameOver");
    const restartBtn = document.getElementById("restartBtn");

    let isDragging = false;
    const snakeBody = [];
    const maxSegments = 10;

    // Enable dragging the player
    player.addEventListener("mousedown", () => { isDragging = true; });
    document.addEventListener("mouseup", () => { isDragging = false; });

    document.addEventListener("mousemove", (e) => {
      if (isDragging) {
        let x = e.clientX - player.offsetWidth / 2;
        let y = e.clientY - player.offsetHeight / 2;

        // Clamp to screen
        x = Math.max(0, Math.min(x, window.innerWidth - player.offsetWidth));
        y = Math.max(0, Math.min(y, window.innerHeight - player.offsetHeight));

        player.style.left = x + "px";
        player.style.top = y + "px";

        updateSnakeBody(x, y);
      }
    });

    function updateSnakeBody(x, y) {
      const segment = document.createElement("div");
      segment.style.width = "20px";
      segment.style.height = "20px";
      segment.style.background = "green";
      segment.style.borderRadius = "50%";
      segment.style.position = "absolute";
      segment.style.left = x + "px";
      segment.style.top = y + "px";
      gameArea.appendChild(segment);
      snakeBody.push(segment);

      if (snakeBody.length > maxSegments) {
        const oldSegment = snakeBody.shift();
        oldSegment.remove();
      }
    }

    // Create falling obstacles
    function createObstacle() {
      const obstacle = document.createElement("div");
      obstacle.classList.add("obstacle");
      obstacle.style.left = Math.random() * (window.innerWidth - 40) + "px";
      gameArea.appendChild(obstacle);

      let y = 0;
      const fall = setInterval(() => {
        y += 5;
        obstacle.style.top = y + "px";

        // Collision detection
        const playerRect = player.getBoundingClientRect();
        const obstacleRect = obstacle.getBoundingClientRect();
        if (
          obstacleRect.top < playerRect.bottom &&
          obstacleRect.bottom > playerRect.top &&
          obstacleRect.left < playerRect.right &&
          obstacleRect.right > playerRect.left
        ) {
          gameOverText.style.display = "block";
          restartBtn.style.display = "block";
          clearInterval(fall);
          clearInterval(spawner);
        }

        // Remove if off screen
        if (y > window.innerHeight) {
          obstacle.remove();
          clearInterval(fall);
        }
      }, 20);
    }

    const spawner = setInterval(createObstacle, 1000);

    // Restart button reloads the game
    restartBtn.addEventListener("click", () => {
      location.reload();
    });
  </script>
</body>
</html>
